<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
                xmlns:ui="http://java.sun.com/jsf/facelets" 
                xmlns:p="http://primefaces.org/ui">

    <p:schedule value="#{asistenciaBean.calendario}" draggable="false" resizable="false" widgetVar="actividades" timeZone="Mexico/General" 
                styleClass="ferbo-schedule" >
        <p:ajax event="eventSelect" listener="#{asistenciaBean.eventoSeleccionado}" update="eventDialog"
                oncomplete="PF('eventDialog').show();"/>
    </p:schedule>

    <p:dialog id="eventDialog" widgetVar="eventDialog" header="Detalle del registro" showEffect="fade" width="350" responsive="true" modal="true">
        <p:outputPanel id="pnlDetalleRegistro" styleClass="ui-fluid p-0" rendered="#{asistenciaBean.evento.dynamicProperties.get('estatus') ne null}">
            <p:panel id="pnlEntrada" rendered="#{asistenciaBean.evento.description eq null}" styleClass="ferbo-panel-no-border">
                <div class="field">
                    <p:outputLabel for="hEntrada" value="Hora de entrada" />
                    <p:calendar id="hEntrada" value="#{asistenciaBean.evento.startDate}" pattern="hh:mm:ss a" disabled="true"
                                timeZone="Mexico/General"/>
                </div>
            </p:panel>
            <p:panel id="pnlSalida" rendered="#{asistenciaBean.evento.description ne null}" styleClass="ferbo-panel-no-border">
                <div class="field">
                    <p:outputLabel for="hSalida" value="Hora de salida" />
                    <p:calendar id="hSalida" value="#{asistenciaBean.evento.endDate}" 
                                pattern="hh:mm:ss a" disabled="true" timeZone="Mexico/General"/>
                    <p:inputText id="registro" rendered="#{asistenciaBean.evento.description eq null}" value="Sin registro" disabled="true"/>
                </div>
            </p:panel>
            <p:panel id="pnlEstatus" rendered="#{asistenciaBean.evento.description eq null}" styleClass="ferbo-panel-no-border">
                <div class="field">
                    <p:outputLabel for="estatus" value="Estatus" />
                    <p:inputText id="estatus" value="#{asistenciaBean.evento.dynamicProperties.get('estatus')}" disabled="true"/>
                </div>
            </p:panel>
        </p:outputPanel>
        <p:outputPanel id="pnlDetallePermiso" styleClass="ui-fluid p-0" rendered="#{asistenciaBean.evento.dynamicProperties.get('estatus') eq null}">
            <div class="field">
                <p:outputLabel for="tipoSol" value="Tipo" />
                <p:inputText id="tipoSol" value="#{asistenciaBean.evento.dynamicProperties.get('tipoSolicitud')}" disabled="true"/>
            </div>
            <p:panel id="pnlFechas" styleClass="ferbo-panel-no-border">
                <div class="field">
                    <p:outputLabel for="fDesde" value="Desde" rendered="#{asistenciaBean.evento.dynamicProperties.get('idTipoSolicitud') eq 2}"/>
                    <p:outputLabel for="fDesde" value="Fecha" rendered="#{asistenciaBean.evento.dynamicProperties.get('idTipoSolicitud') ne 2}"/>
                    <p:calendar id="fDesde" value="#{asistenciaBean.evento.startDate}" pattern="dd/MM/yyyy" disabled="true"
                                timeZone="Mexico/General"/>
                </div>
                <div class="field">
                    <p:outputLabel for="fHasta" value="Hasta" rendered="#{asistenciaBean.evento.dynamicProperties.get('idTipoSolicitud') eq 2}"/>
                    <p:calendar id="fHasta" value="#{asistenciaBean.evento.endDate}" pattern="dd/MM/yyyy" disabled="true"
                                timeZone="Mexico/General" rendered="#{asistenciaBean.evento.dynamicProperties.get('idTipoSolicitud') eq 2}"/>
                </div>
            </p:panel>
        </p:outputPanel>
    </p:dialog>        
    <style>
        .ferbo-panel-no-border .ui-panel-content{
            padding: 0 !important;
            border: none !important;
        }

        .ferbo-schedule .fc-daygrid-day-frame {
            max-height: 6rem;
        }
        .ferbo-schedule .fc-h-event .fc-event-main-frame {
            display: flex;
            text-align: center;
        }
    </style>
    <script  type="text/javascript">
        window.onload = function () {
            Array.from(document.getElementsByClassName('fc-event-title')).forEach(function (element) {
                console.log(element);
                if (element.getInnerHTML().at(0) === 'E') {
                    element.setHTML('Entrada<br/>'.concat(element.getInnerHTML().replace('Entrada', '')));
                } else if ((element.getInnerHTML().at(0) === 'S')) {
                    element.setHTML('Salida<br/>'.concat(element.getInnerHTML().replace('Salida', '')));
                }
            });
        };
    </script>
</ui:composition>
